pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
 
 for i=1,50 do
 	add(game.ent,sprite:new({
 		x=rnd(127),
 		y=rnd(127),
 	}))
 end
end

function _update()
	game:update()
end

function _draw()
	cls()
	game:draw()
end
-->8
-- class & entities
global=_ENV

class=setmetatable({
	new=function(self, tbl)
		tbl=tbl or {}
		setmetatable(tbl,{
			__index=self
		})
		return tbl
	end,
},{__index=_ENV})

entity=class:new({
	x=0,
	y=0,
	update=function(_ENV)
	end,
	draw=function(_ENV)
	end
	
})

game=class:new{
	t=0,
	ent={},
	
	update=function(_ENV)
		t+=1
	 for e in all(ent) do
	  e:update()
	 end
	end,
	
	draw=function(_ENV)
		for e in all(ent) do
			e:draw()
		end
	end
}

sprite=entity:new({
 ani=1,
 len=2,
 ani_spd=10,
 flip_x=false,
 flip_y=false,
 
 draw=function(_ENV)
 	spr(ani+(global.game.t/ani_spd) % len,
 		x,
 		y,
 		1,
 		1,
 		flip_x,
 		flip_y)
 end
})


-->8
-- example usage

star=entity:new({
	x=64,
	y=-1,
	spd=.5,
	rad=0,
	clr=13,
	
	update=function(self)
		self.y+=self.spd
		if self.y-self.rad > 127 then
			self.y=-self.rad
		end
	end,
	
	draw=function(self)
		circfill(
			self.x,
			self.y,
			self.rad,
			self.clr
		)
	end,
})

far_star=star:new({
	clr=1,
	spd=.25,
	rad=0
})

near_star=star:new({
	clr=7,
	spd=.75,
	rad=1,
	
	new=function(self, tbl)
		tbl=star.new(self,tbl)
		
		tbl.spd=tbl.spd+rnd(.3)
		return tbl
	end
})

__gfx__
00000000000880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008e88000888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000008e8888008ee888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000008e88888808e8888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000088888800888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008888000888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
011000000c053000000000028500246530000000000285000c05300000000032850024653285000c053000000c0530000000003000002465300000000030c053000000c053000002850024653285002465330500
011000000c55002500045000c550025000c5500c5500e500045000050002500045000050002500045000050002500045000050002500045000050002500045000050002500045000050002500045000050002500
